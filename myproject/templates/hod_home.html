{% extends 'dashboard.html' %}
{% block header %}
{% endblock %}
{% block mynav %}
<div class="container mt-4">
  <h3><b>Welcome Admin Suzzan!!</b></h3>
  <div class="row mt-3">

    <div class="col-md-4">
      <div class="card shadow-sm p-3 text-center">
        <h5>üë©‚Äçüè´ Staff</h5>
        <h2>{{ staff_count }}</h2>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm p-3 text-center">
        <h5>üìò Courses</h5>
        <h2>{{ course_count }}</h2>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm p-3 text-center">
        <h5>üìö Subjects</h5>
        <h2>{{ subject_count }}</h2>
      </div>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col-md-4">
      <div class="card shadow-sm p-3">
        <h5 class="text-center">All Data</h5>
        <canvas id="allDataChart"></canvas>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm p-3">
        <h5 class="text-center">Gender Distribution</h5>
        <canvas id="genderChart"></canvas>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm p-3">
        <h5 class="text-center">Courses and Subjects</h5>
        <canvas id="courseSubjectChart"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Chart.js -->
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// Wait for DOM to be ready
window.addEventListener('DOMContentLoaded', function() {
  console.log("Staff:", {{ staff_count }}, "Course:", {{ course_count }}, "Subject:", {{ subject_count }});
  console.log("Male:", {{ male_count }}, "Female:", {{ female_count }});

  // All Data Pie
  const allDataChart = document.getElementById("allDataChart");
  if (allDataChart) {
    new Chart(allDataChart, {
      type: "pie",
      data: {
        labels: ["Staffs", "Courses", "Subjects"],
        datasets: [{
          data: [{{ staff_count }}, {{ course_count }}, {{ subject_count }}],
          backgroundColor: ["#36A2EB", "#FFCE56", "#FF6384"]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: { position: 'right' }
        }
      }
    });
  }

  // Gender Pie
  const genderChart = document.getElementById("genderChart");
  if (genderChart) {
    new Chart(genderChart, {
      type: "doughnut",
      data: {
        labels: ["Male", "Female"],
        datasets: [{
          data: [{{ male_count }}, {{ female_count }}],
          backgroundColor: ["#36A2EB", "#4BC0C0"]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: { legend: { position: 'right' } }
      }
    });
  }

  // Courses vs Subjects Pie
  const courseSubjectChart = document.getElementById("courseSubjectChart");
  if (courseSubjectChart) {
    new Chart(courseSubjectChart, {
      type: "doughnut",
      data: {
        labels: ["Courses", "Subjects"],
        datasets: [{
          data: [{{ course_count }}, {{ subject_count }}],
          backgroundColor: ["#36A2EB", "#4BC0C0"]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: { legend: { position: 'right' } }
      }
    });
  }
});
</script>
{% endblock %}
